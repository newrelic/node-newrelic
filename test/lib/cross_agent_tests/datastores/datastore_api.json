[
  {
    "test_name": "all required fields present, everything enabled",
    "input":{
      "parameters":{
        "product":"MySQL",
        "collection":"users",
        "operation":"INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      },
      "is_web":true,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allWeb",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/statement/MySQL/users/INSERT",
        "Datastore/instance/MySQL/db-server-1/3306"
      ],
      "metrics_scoped":[
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/statement/MySQL/users/INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      }
    }
  },
  {
    "test_name": "database name missing",
    "input":{
      "parameters":{
        "product":"MySQL",
        "collection":"users",
        "operation":"INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306"
      },
      "is_web":true,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allWeb",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/statement/MySQL/users/INSERT",
        "Datastore/instance/MySQL/db-server-1/3306"
      ],
      "metrics_scoped":[
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/statement/MySQL/users/INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306"
      }
    }
  },
  {
    "test_name": "host and port missing",
    "input":{
      "parameters":{
        "product":"MySQL",
        "collection":"users",
        "operation":"INSERT",
        "database_name":"my_db"
      },
      "is_web":true,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allWeb",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "metrics_scoped":[
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/statement/MySQL/users/INSERT",
        "database_name":"my_db"
      }
    }
  },
  {
    "test_name": "host missing, but port present",
    "input":{
      "parameters":{
        "product":"MySQL",
        "collection":"users",
        "operation":"INSERT",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      },
      "is_web":true,
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allWeb",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/statement/MySQL/users/INSERT",
        "Datastore/instance/MySQL/unknown/3306"
      ],
      "metrics_scoped":[
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/statement/MySQL/users/INSERT",
        "host":"unknown",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      }
    }
  },
  {
    "test_name": "instance reporting false",
    "input":{
      "parameters":{
        "product":"MySQL",
        "collection":"users",
        "operation":"INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      },
      "is_web":true,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":false,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allWeb",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "metrics_scoped":[
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/statement/MySQL/users/INSERT",
        "database_name":"my_db"
      }
    }
  },
  {
    "test_name": "database name disabled",
    "input":{
      "parameters":{
        "product":"MySQL",
        "collection":"users",
        "operation":"INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      },
      "is_web":true,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":false
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allWeb",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/statement/MySQL/users/INSERT",
        "Datastore/instance/MySQL/db-server-1/3306"
      ],
      "metrics_scoped":[
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/statement/MySQL/users/INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306"
      }
    }
  },
  {
    "test_name": "all fields missing",
    "input":{
      "parameters":{
      },
      "is_web":true,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/Unknown/all",
        "Datastore/Unknown/allWeb",
        "Datastore/operation/Unknown/other"
      ],
      "metrics_scoped":[
        "Datastore/operation/Unknown/other"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/operation/Unknown/other"
      }
    }
  },
  {
    "test_name": "missing collection",
    "input":{
      "parameters":{
        "product":"MySQL",
        "operation":"INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      },
      "is_web":true,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allWeb",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/instance/MySQL/db-server-1/3306"
      ],
      "metrics_scoped":[
        "Datastore/operation/MySQL/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/operation/MySQL/INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      }
    }
  },
  {
    "test_name": "host present, port missing",
    "input":{
      "parameters":{
        "product":"MySQL",
        "collection":"users",
        "operation":"INSERT",
        "host":"db-server-1",
        "database_name":"my_db"
      },
      "is_web":true,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allWeb",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/statement/MySQL/users/INSERT",
        "Datastore/instance/MySQL/db-server-1/unknown"
      ],
      "metrics_scoped":[
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/statement/MySQL/users/INSERT",
        "host":"db-server-1",
        "port_path_or_id":"unknown",
        "database_name":"my_db"
      }
    }
  },
  {
    "test_name": "localhost replacement",
    "input":{
      "parameters":{
        "product":"MySQL",
        "collection":"users",
        "operation":"INSERT",
        "host":"localhost",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      },
      "is_web":true,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allWeb",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/statement/MySQL/users/INSERT",
        "Datastore/instance/MySQL/datanerd-01/3306"
      ],
      "metrics_scoped":[
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/statement/MySQL/users/INSERT",
        "host":"datanerd-01",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      }
    }
  },
  {
    "test_name": "background transaction",
    "input":{
      "parameters":{
        "product":"MySQL",
        "collection":"users",
        "operation":"INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      },
      "is_web":false,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allOther",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allOther",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/statement/MySQL/users/INSERT",
        "Datastore/instance/MySQL/db-server-1/3306"
      ],
      "metrics_scoped":[
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/statement/MySQL/users/INSERT",
        "host":"db-server-1",
        "port_path_or_id":"3306",
        "database_name":"my_db"
      }
    }
  },
  {
    "test_name": "socket path port",
    "input":{
      "parameters":{
        "product":"MySQL",
        "collection":"users",
        "operation":"INSERT",
        "host":"db-server-1",
        "port_path_or_id":"/var/mysql/mysql.sock",
        "database_name":"my_db"
      },
      "is_web":true,
      "system_hostname":"datanerd-01",
      "configuration":{
        "datastore_tracer.instance_reporting.enabled":true,
        "datastore_tracer.database_name_reporting.enabled":true
      }
    },
    "expectation":{
      "metrics_unscoped":[
        "Datastore/all",
        "Datastore/allWeb",
        "Datastore/MySQL/all",
        "Datastore/MySQL/allWeb",
        "Datastore/operation/MySQL/INSERT",
        "Datastore/statement/MySQL/users/INSERT",
        "Datastore/instance/MySQL/db-server-1//var/mysql/mysql.sock"
      ],
      "metrics_scoped":[
        "Datastore/statement/MySQL/users/INSERT"
      ],
      "transaction_segment_and_slow_query_trace":{
        "metric_name":"Datastore/statement/MySQL/users/INSERT",
        "host":"db-server-1",
        "port_path_or_id":"/var/mysql/mysql.sock",
        "database_name":"my_db"
      }
    }
  }
]
