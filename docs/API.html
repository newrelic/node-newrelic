<!DOCTYPE html><html lang="en" style="font-size:16px"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Class: API</title><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="scripts/third-party/hljs.js" defer="defer"></script><script src="scripts/third-party/hljs-line-num.js" defer="defer"></script><script src="scripts/third-party/popper.js" defer="defer"></script><script src="scripts/third-party/tippy.js" defer="defer"></script><script src="scripts/third-party/tocbot.min.js"></script><script>var baseURL="/",locationPathname="";baseURL=(locationPathname=document.location.pathname).substr(0,locationPathname.lastIndexOf("/")+1)</script><link rel="stylesheet" href="styles/clean-jsdoc-theme-without-scrollbar.min.css"><svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><defs><symbol id="copy-icon" viewbox="0 0 488.3 488.3"><g><path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/><path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/></g></symbol><symbol id="search-icon" viewBox="0 0 512 512"><g><g><path d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z"/></g></g><g><g><path d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z"/></g></g></symbol><symbol id="font-size-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11.246 15H4.754l-2 5H.6L7 4h2l6.4 16h-2.154l-2-5zm-.8-2L8 6.885 5.554 13h4.892zM21 12.535V12h2v8h-2v-.535a4 4 0 1 1 0-6.93zM19 18a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></symbol><symbol id="add-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"/></symbol><symbol id="minus-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M5 11h14v2H5z"/></symbol><symbol id="dark-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol><symbol id="light-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol><symbol id="reset-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"/></symbol><symbol id="down-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"></path></symbol><symbol id="codepen-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.5 13.202L13 15.535v3.596L19.197 15 16.5 13.202zM14.697 12L12 10.202 9.303 12 12 13.798 14.697 12zM20 10.869L18.303 12 20 13.131V10.87zM19.197 9L13 4.869v3.596l3.5 2.333L19.197 9zM7.5 10.798L11 8.465V4.869L4.803 9 7.5 10.798zM4.803 15L11 19.131v-3.596l-3.5-2.333L4.803 15zM4 13.131L5.697 12 4 10.869v2.262zM2 9a1 1 0 0 1 .445-.832l9-6a1 1 0 0 1 1.11 0l9 6A1 1 0 0 1 22 9v6a1 1 0 0 1-.445.832l-9 6a1 1 0 0 1-1.11 0l-9-6A1 1 0 0 1 2 15V9z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></symbol></defs></svg></head><body data-theme="dark"><div class="sidebar-container"><div class="sidebar" id="sidebar"><div class="sidebar-items-container"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="API.html">API</a></div><div class="sidebar-section-children"><a href="ClassWrapSpec.html">ClassWrapSpec</a></div><div class="sidebar-section-children"><a href="DatastoreParameters.html">DatastoreParameters</a></div><div class="sidebar-section-children"><a href="DatastoreShim.html">DatastoreShim</a></div><div class="sidebar-section-children"><a href="InstrumentationDescriptor.html">InstrumentationDescriptor</a></div><div class="sidebar-section-children"><a href="MessageShim.html">MessageShim</a></div><div class="sidebar-section-children"><a href="MessageSpec.html">MessageSpec</a></div><div class="sidebar-section-children"><a href="MessageSubscribeSpec.html">MessageSubscribeSpec</a></div><div class="sidebar-section-children"><a href="MiddlewareMounterSpec.html">MiddlewareMounterSpec</a></div><div class="sidebar-section-children"><a href="MiddlewareSpec.html">MiddlewareSpec</a></div><div class="sidebar-section-children"><a href="OperationSpec.html">OperationSpec</a></div><div class="sidebar-section-children"><a href="PromiseShim.html">PromiseShim</a></div><div class="sidebar-section-children"><a href="QuerySpec.html">QuerySpec</a></div><div class="sidebar-section-children"><a href="QueueMessageParameters.html">QueueMessageParameters</a></div><div class="sidebar-section-children"><a href="RecorderSpec.html">RecorderSpec</a></div><div class="sidebar-section-children"><a href="RenderSpec.html">RenderSpec</a></div><div class="sidebar-section-children"><a href="SegmentSpec.html">SegmentSpec</a></div><div class="sidebar-section-children"><a href="Shim.html">Shim</a></div><div class="sidebar-section-children"><a href="TransactionHandle.html">TransactionHandle</a></div><div class="sidebar-section-children"><a href="TransactionShim.html">TransactionShim</a></div><div class="sidebar-section-children"><a href="TransactionSpec.html">TransactionSpec</a></div><div class="sidebar-section-children"><a href="WebFrameworkShim.html">WebFrameworkShim</a></div><div class="sidebar-section-children"><a href="WrapSpec.html">WrapSpec</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-instrumentation.html">Instrumentation Examples</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-interfaces"><div>Interfaces</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="ParsedQueryData.html">ParsedQueryData</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-global"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#CallbackBindFunction">CallbackBindFunction</a></div><div class="sidebar-section-children"><a href="global.html#ClassWrapSpecParams">ClassWrapSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#ConstructorHookFunction">ConstructorHookFunction</a></div><div class="sidebar-section-children"><a href="global.html#DatastoreParametersParams">DatastoreParametersParams</a></div><div class="sidebar-section-children"><a href="global.html#InContextCallback">InContextCallback</a></div><div class="sidebar-section-children"><a href="global.html#InstrumentationDescriptorParams">InstrumentationDescriptorParams</a></div><div class="sidebar-section-children"><a href="global.html#InstrumentationOnError">InstrumentationOnError</a></div><div class="sidebar-section-children"><a href="global.html#InstrumentationOnRequire">InstrumentationOnRequire</a></div><div class="sidebar-section-children"><a href="global.html#MessageBrokerHeadersFn">MessageBrokerHeadersFn</a></div><div class="sidebar-section-children"><a href="global.html#MessageConsumerWrapperFunction">MessageConsumerWrapperFunction</a></div><div class="sidebar-section-children"><a href="global.html#MessageFunction">MessageFunction</a></div><div class="sidebar-section-children"><a href="global.html#MessageHandlerFunction">MessageHandlerFunction</a></div><div class="sidebar-section-children"><a href="global.html#MessageSpecParams">MessageSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#MessageSubscribeSpecParams">MessageSubscribeSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#MiddlewareMounterSpecParams">MiddlewareMounterSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#MiddlewareSpecParams">MiddlewareSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#MiddlewareTypeNames">MiddlewareTypeNames</a></div><div class="sidebar-section-children"><a href="global.html#MiddlewareWrapperFunction">MiddlewareWrapperFunction</a></div><div class="sidebar-section-children"><a href="global.html#OperationSpecParams">OperationSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#QueryFunction">QueryFunction</a></div><div class="sidebar-section-children"><a href="global.html#QueryParserFunction">QueryParserFunction</a></div><div class="sidebar-section-children"><a href="global.html#QuerySpecFunction">QuerySpecFunction</a></div><div class="sidebar-section-children"><a href="global.html#QuerySpecParams">QuerySpecParams</a></div><div class="sidebar-section-children"><a href="global.html#QueueMessageParametersParams">QueueMessageParametersParams</a></div><div class="sidebar-section-children"><a href="global.html#RecorderFunction">RecorderFunction</a></div><div class="sidebar-section-children"><a href="global.html#RecorderSpecParams">RecorderSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#RenderSpecParams">RenderSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#ResponsePredicate">ResponsePredicate</a></div><div class="sidebar-section-children"><a href="global.html#RouteNextFunction">RouteNextFunction</a></div><div class="sidebar-section-children"><a href="global.html#RouteParameterFunction">RouteParameterFunction</a></div><div class="sidebar-section-children"><a href="global.html#RouteParserFunction">RouteParserFunction</a></div><div class="sidebar-section-children"><a href="global.html#RouteRequestFunction">RouteRequestFunction</a></div><div class="sidebar-section-children"><a href="global.html#SegmentFunction">SegmentFunction</a></div><div class="sidebar-section-children"><a href="global.html#SegmentSpecParams">SegmentSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#SpecAfterFunction">SpecAfterFunction</a></div><div class="sidebar-section-children"><a href="global.html#TransactionSpecParams">TransactionSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#WrapFunction">WrapFunction</a></div><div class="sidebar-section-children"><a href="global.html#WrapSpecParams">WrapSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#createShimFromType">createShimFromType</a></div><div class="sidebar-section-children"><a href="global.html#getDatabaseNameFromUseQuery">getDatabaseNameFromUseQuery</a></div><div class="sidebar-section-children"><a href="global.html#startSegmentCallback">startSegmentCallback</a></div></div></div></div></div><div class="navbar-container" id="VuAckcnZhf"><nav class="navbar"><div class="navbar-left-items"></div><div class="navbar-right-items"><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div><nav></nav></nav></div><div class="toc-container"><div class="toc-content"><span class="bold">On this page</span><div id="eed4d2a0bfd64539bb9df78095dec881"></div></div></div><div class="body-wrapper"><div class="main-content"><div class="main-wrapper"><section><header><h1 id="API-title" class="has-anchor">API</h1></header><article><div class="container-overview"><h3 class="name has-anchor" id="API"><span class="type-signature"></span>new API<span class="signature">(agent)</span></h3><div class="description"><p>The exported New Relic API. This contains all of the functions meant to be used by New Relic customers.</p><p>You do not need to directly instantiate this class, as an instance of this is the return from <code>require('newrelic')</code>.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>agent</code></td><td class="type"><span class="param-type">object</span></td><td class="description last"><p>Instantiation of lib/agent.js</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line73">line 73</a></li></ul></dd></div></dl></div><h2 id="methods" class="subsection-title has-anchor">Methods</h2><h3 class="name has-anchor" id="addCustomAttribute"><span class="type-signature"></span>addCustomAttribute<span class="signature">(key, value)</span><span class="type-signature"> &rarr; {false|undefined}</span></h3><div class="description"><p>Add a custom attribute to the current transaction and span. Some attributes are reserved (see CUSTOM_DENYLIST for the current, very short list), and as with most API methods, this must be called in the context of an active transaction. Most recently set value wins.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>key</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The key you want displayed in the RPM UI.</p></td></tr><tr><td class="name"><code>value</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The value you want displayed. Must be serializable.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line257">line 257</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>Returns false when disabled/errored, otherwise undefined</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">false</span> |<wbr> <span class="param-type">undefined</span></dd></dl></div><h3 class="name has-anchor" id="addCustomAttributes"><span class="type-signature"></span>addCustomAttributes<span class="signature">(atts<span class="signature-attributes">opt</span>)</span></h3><div class="description"><p>Adds all custom attributes in an object to the current transaction and span.</p><p>See documentation for newrelic.addCustomAttribute for more information on setting custom attributes.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>atts</code></td><td class="type"><span class="param-type">object</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Attribute object</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>KEY</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>The name you want displayed in the RPM UI.</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>VALUE</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>The value you want displayed. Must be serializable.</p></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line314">line 314</a></li></ul></dd></div></dl><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>newrelic.addCustomAttributes({test: 'value', test2: 'value2'});</code></pre></div></div><h3 class="name has-anchor" id="addCustomSpanAttribute"><span class="type-signature"></span>addCustomSpanAttribute<span class="signature">(key, value)</span><span class="type-signature"> &rarr; {false|undefined}</span></h3><div class="description"><p>Add a custom span attribute to the current transaction. Some attributes are reserved (see CUSTOM_DENYLIST for the current, very short list), and as with most API methods, this must be called in the context of an active segment/span. Most recently set value wins.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>key</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The key you want displayed in the RPM UI.</p></td></tr><tr><td class="name"><code>value</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The value you want displayed. Must be serializable.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line365">line 365</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>Returns false when disabled/errored, otherwise undefined</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">false</span> |<wbr> <span class="param-type">undefined</span></dd></dl></div><h3 class="name has-anchor" id="addCustomSpanAttributes"><span class="type-signature"></span>addCustomSpanAttributes<span class="signature">(atts<span class="signature-attributes">opt</span>)</span></h3><div class="description"><p>Add custom span attributes in an object to the current segment/span.</p><p>See documentation for newrelic.addCustomSpanAttribute for more information.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>atts</code></td><td class="type"><span class="param-type">object</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Attribute object</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>KEY</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>The name you want displayed in the RPM UI.API.</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>VALUE</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>The value you want displayed. Must be serializable.</p></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line342">line 342</a></li></ul></dd></div></dl><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>newrelic.addCustomSpanAttribute({test: 'value', test2: 'value2'})</code></pre></div></div><h3 class="name has-anchor" id="addIgnoringRule"><span class="type-signature"></span>addIgnoringRule<span class="signature">(pattern)</span><span class="type-signature"> &rarr; {void}</span></h3><div class="description"><p>If the URL for a transaction matches the provided pattern, ignore the transaction attached to that URL. Useful for filtering socket.io connections and other long-polling requests out of your agents to keep them from distorting an app's apdex or mean response time. Pattern may be a (standard JavaScript) RegExp or a string.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>pattern</code></td><td class="type"><span class="param-type">RegExp</span></td><td class="description last"><p>The pattern to ignore.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line597">line 597</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">void</span></dd></dl></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>newrelic.addIgnoringRule('^/socket\\.io/')</code></pre></div></div><h3 class="name has-anchor" id="addNamingRule"><span class="type-signature"></span>addNamingRule<span class="signature">(pattern, name)</span><span class="type-signature"> &rarr; {void}</span></h3><div class="description"><p>If the URL for a transaction matches the provided pattern, name the transaction with the provided name. If there are capture groups in the pattern (which is a standard JavaScript regular expression, and can be passed as either a RegExp or a string), then the substring matches ($1, $2, etc.) are replaced in the name string. BE CAREFUL WHEN USING SUBSTITUTION. If the replacement substrings are highly variable (i.e. are identifiers, GUIDs, or timestamps), the rule will generate too many metrics and potentially get your application blocked by New Relic.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>pattern</code></td><td class="type"><span class="param-type">RegExp</span></td><td class="description last"><p>The pattern to rename (with capture groups).</p></td></tr><tr><td class="name"><code>name</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The name to use for the transaction.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line573">line 573</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">void</span></dd></dl></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Examples</strong><div class="rel"><pre class="prettyprint"><code>// An example of a good rule with replacements:
newrelic.addNamingRule('^/storefront/(v[1-5])/(item|category|tag)',
                       'CommerceAPI/$1/$2')</code></pre></div><div class="rel"><pre class="prettyprint"><code>// An example of a bad rule with replacements:
newrelic.addNamingRule('^/item/([0-9a-f]+)', 'Item/$1')

// Keep in mind that the original URL and any query parameters will be sent
// along with the request, so slow transactions will still be identifiable.

// Naming rules can not be removed once added. They can also be added via the
// agent's configuration. See configuration documentation for details.</code></pre></div></div><h3 class="name has-anchor" id="endTransaction"><span class="type-signature"></span>endTransaction<span class="signature">()</span></h3><div class="description"><p>End the current web or background custom transaction. This method requires being in the correct transaction context when called.</p></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1126">line 1126</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="getBrowserTimingHeader"><span class="type-signature"></span>getBrowserTimingHeader<span class="signature">(options)</span><span class="type-signature"> &rarr; {string}</span></h3><div class="description"><p>Get the script header necessary for Browser Monitoring This script must be manually injected into your templates, as high as possible in the header, but <em>after</em> any X-UA-COMPATIBLE HTTP-EQUIV meta tags. Otherwise you may hurt IE!</p><p>By default this method will return a script wrapped by <code>&lt;script&gt;</code> tags, but with option <code>hasToRemoveScriptWrapper</code> it can send back only the script content without the <code>&lt;script&gt;</code> wrapper. Useful for React component based frontend.</p><p>This method must be called every time you want to generate the headers.</p><p>Do <em>not</em> reuse the headers between users, or even between requests.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>options</code></td><td class="type"><span class="param-type">object</span></td><td class="description last"><p>configuration options</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>nonce</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Nonce to inject into <code>&lt;script&gt;</code> header.</p></td></tr><tr><td class="name"><code>hasToRemoveScriptWrapper</code></td><td class="type"><span class="param-type">boolean</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Used to import agent script without <code>&lt;script&gt;</code> tag wrapper.</p></td></tr><tr><td class="name"><code>allowTransactionlessInjection</code></td><td class="type"><span class="param-type">options</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Whether or not to allow the Browser Agent to be injected when there is no active transaction</p></td></tr></tbody></table></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line751">line 751</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>The script content to be injected in <code>&lt;head&gt;</code> or put inside <code>&lt;script&gt;</code> tag (depending on options)</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">string</span></dd></dl></div><h3 class="name has-anchor" id="getLinkingMetadata"><span class="type-signature"></span>getLinkingMetadata<span class="signature">(omitSupportability)</span><span class="type-signature"> &rarr; {object}</span></h3><div class="description"><p>This method returns an object with the following keys/data:</p><ul><li><code>trace.id</code>: The current trace ID</li><li><code>span.id</code>: The current span ID</li><li><code>entity.name</code>: The application name specified in the connect request as app_name. If multiple application names are specified this will only be the first name</li><li><code>entity.type</code>: The string &quot;SERVICE&quot;</li><li><code>entity.guid</code>: The entity ID returned in the connect reply as entity_guid</li><li><code>hostname</code>: The hostname as specified in the connect request as utilization.full_hostname. If utilization.full_hostname is null or empty, this will be the hostname specified in the connect request as host.</li></ul></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>omitSupportability</code></td><td class="type"><span class="param-type">boolean</span></td><td class="description last"><p>Whether or not to log the supportability metric, true means skip</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line159">line 159</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>The LinkingMetadata object with the data above</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">object</span></dd></dl></div><h3 class="name has-anchor" id="getTraceMetadata"><span class="type-signature"></span>getTraceMetadata<span class="signature">()</span><span class="type-signature"> &rarr; {*}</span></h3><div class="description"><p>Returns the current trace and span id.</p></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1536">line 1536</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>The object containing the current trace and span ids</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">*</span></dd></dl></div><h3 class="name has-anchor" id="getTransaction"><span class="type-signature"></span>getTransaction<span class="signature">()</span><span class="type-signature"> &rarr; {<a href="TransactionHandle.html">TransactionHandle</a>}</span></h3><div class="description"><p>This method returns an object with the following methods:</p><ul><li><p>end: end the transaction that was active when <code>API#getTransaction</code> was called.</p></li><li><p>ignore: set the transaction that was active when <code>API#getTransaction</code> was called to be ignored.</p></li></ul></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line128">line 128</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>The transaction object with the <code>end</code> and <code>ignore</code> methods on it.</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type"><a href="TransactionHandle.html">TransactionHandle</a></span></dd></dl></div><h3 class="name has-anchor" id="ignoreApdex"><span class="type-signature"></span>ignoreApdex<span class="signature">()</span></h3><div class="description"><p>Ignores the current transaction when calculating your <a href="https://docs.newrelic.com/docs/apm/new-relic-apm/apdex/apdex-measuring-user-satisfaction/">Apdex score</a>. This is useful when you have either very short or very long transactions (such as file downloads) that can skew your Apdex score.</p></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1913">line 1913</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="incrementMetric"><span class="type-signature"></span>incrementMetric<span class="signature">(name, value<span class="signature-attributes">opt</span>)</span></h3><div class="description"><p>Create or update a custom metric that acts as a simple counter. The count of the given metric will be incremented by the specified amount, defaulting to 1.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>name</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>The name of the metric.</p></td></tr><tr><td class="name"><code>value</code></td><td class="type"><span class="param-type">number</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>The amount that the count of the metric should be incremented by. Defaults to 1.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1218">line 1218</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="instrument"><span class="type-signature"></span>instrument<span class="signature">(moduleName, onRequire, onError)</span></h3><div class="description"><p>Registers an instrumentation function.</p><ul><li><code>newrelic.instrument(moduleName, onRequire [,onError])</code></li><li><code>newrelic.instrument(options)</code></li></ul></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span> |<wbr> <span class="param-type">object</span></td><td class="description last"><p>The module name given to require to load the module, or the instrumentation specification</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>The module name given to require to load the module</p></td></tr><tr><td class="name"><code>absolutePath</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Must provide absolute path to module if it does not exist within node_modules. This is used to instrument a file within the same application.</p></td></tr><tr><td class="name"><code>onRequire</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes"></td><td class="description last"><p>The function to call when the module has been loaded</p></td></tr><tr><td class="name"><code>onError</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>If provided, should <code>onRequire</code> throw an error, the error will be passed to</p></td></tr></tbody></table></td></tr><tr><td class="name"><code>onRequire</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>The function to call when the module has been loaded</p></td></tr><tr><td class="name"><code>onError</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>If provided, should <code>onRequire</code> throw an error, the error will be passed to this function.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1340">line 1340</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="instrumentConglomerate"><span class="type-signature"></span>instrumentConglomerate<span class="signature">(moduleName, onRequire, onError)</span></h3><div class="description"><p>Registers an instrumentation function.</p><ul><li><code>newrelic.instrumentConglomerate(moduleName, onRequire [, onError])</code></li><li><code>newrelic.instrumentConglomerate(options)</code></li></ul></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span> |<wbr> <span class="param-type">object</span></td><td class="description last"><p>The module name given to require to load the module, or the instrumentation specification</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>The module name given to require to load the module</p></td></tr><tr><td class="name"><code>absolutePath</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Must provide absolute path to module if it does not exist within node_modules. This is used to instrument a file within the same application.</p></td></tr><tr><td class="name"><code>onRequire</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes"></td><td class="description last"><p>The function to call when the module has been loaded</p></td></tr><tr><td class="name"><code>onError</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>If provided, should <code>onRequire</code> throw an error, the error will be passed to</p></td></tr></tbody></table></td></tr><tr><td class="name"><code>onRequire</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>The function to call when the module has been loaded</p></td></tr><tr><td class="name"><code>onError</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>If provided, should <code>onRequire</code> throw an error, the error will be passed to this function.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1371">line 1371</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="instrumentDatastore"><span class="type-signature"></span>instrumentDatastore<span class="signature">(moduleName, onRequire, onError)</span></h3><div class="description"><p>Registers an instrumentation function.</p><ul><li><code>newrelic.instrumentDatastore(moduleName, onRequire [,onError])</code></li><li><code>newrelic.instrumentDatastore(options)</code></li></ul></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span> |<wbr> <span class="param-type">object</span></td><td class="description last"><p>The module name given to require to load the module, or the instrumentation specification</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>The module name given to require to load the module</p></td></tr><tr><td class="name"><code>absolutePath</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Must provide absolute path to module if it does not exist within node_modules. This is used to instrument a file within the same application.</p></td></tr><tr><td class="name"><code>onRequire</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes"></td><td class="description last"><p>The function to call when the module has been loaded</p></td></tr><tr><td class="name"><code>onError</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>If provided, should <code>onRequire</code> throw an error, the error will be passed to</p></td></tr></tbody></table></td></tr><tr><td class="name"><code>onRequire</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>The function to call when the module has been loaded</p></td></tr><tr><td class="name"><code>onError</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>If provided, should <code>onRequire</code> throw an error, the error will be passed to this function.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1403">line 1403</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="instrumentLoadedModule"><span class="type-signature"></span>instrumentLoadedModule<span class="signature">(moduleName, module)</span><span class="type-signature"> &rarr; {boolean}</span></h3><div class="description"><p>Applies an instrumentation to an already loaded CommonJs module.</p><p>Note: This function will not work for ESM packages.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The module's name/identifier. Will be normalized into an instrumentation key.</p></td></tr><tr><td class="name"><code>module</code></td><td class="type"><span class="param-type">object</span></td><td class="description last"><p>The actual module object or function we're instrumenting</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1513">line 1513</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>Whether or not the module was successfully instrumented</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">boolean</span></dd></dl></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>// oh no, express was loaded before newrelic
const express   = require('express')
const newrelic  = require('newrelic')

// phew, we can use instrumentLoadedModule to make
// sure express is still instrumented
newrelic.instrumentLoadedModule('express', express)</code></pre></div></div><h3 class="name has-anchor" id="instrumentMessages"><span class="type-signature"></span>instrumentMessages<span class="signature">(moduleName, onRequire, onError)</span></h3><div class="description"><p>Registers an instrumentation function for instrumenting message brokers.</p><ul><li><code>newrelic.instrumentMessages(moduleName, onRequire [,onError])</code></li><li><code>newrelic.instrumentMessages(options)</code></li></ul></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span> |<wbr> <span class="param-type">object</span></td><td class="description last"><p>The module name given to require to load the module, or the instrumentation specification</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>The module name given to require to load the module</p></td></tr><tr><td class="name"><code>absolutePath</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Must provide absolute path to module if it does not exist within node_modules. This is used to instrument a file within the same application.</p></td></tr><tr><td class="name"><code>onRequire</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes"></td><td class="description last"><p>The function to call when the module has been loaded</p></td></tr><tr><td class="name"><code>onError</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>If provided, should <code>onRequire</code> throw an error, the error will be passed to</p></td></tr></tbody></table></td></tr><tr><td class="name"><code>onRequire</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>The function to call when the module has been loaded</p></td></tr><tr><td class="name"><code>onError</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>If provided, should <code>onRequire</code> throw an error, the error will be passed to this function.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1473">line 1473</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="instrumentWebframework"><span class="type-signature"></span>instrumentWebframework<span class="signature">(moduleName, onRequire, onError)</span></h3><div class="description"><p>Registers an instrumentation function.</p><ul><li><code>newrelic.instrumentWebframework(moduleName, onRequire [,onError])</code></li><li><code>newrelic.instrumentWebframework(options)</code></li></ul></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span> |<wbr> <span class="param-type">object</span></td><td class="description last"><p>The module name given to require to load the module, or the instrumentation specification</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>moduleName</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>The module name given to require to load the module</p></td></tr><tr><td class="name"><code>absolutePath</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Must provide absolute path to module if it does not exist within node_modules. This is used to instrument a file within the same application.</p></td></tr><tr><td class="name"><code>onRequire</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes"></td><td class="description last"><p>The function to call when the module has been loaded</p></td></tr><tr><td class="name"><code>onError</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>If provided, should <code>onRequire</code> throw an error, the error will be passed to</p></td></tr></tbody></table></td></tr><tr><td class="name"><code>onRequire</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>The function to call when the module has been loaded</p></td></tr><tr><td class="name"><code>onError</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>If provided, should <code>onRequire</code> throw an error, the error will be passed to this function.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1436">line 1436</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="noticeError"><span class="type-signature"></span>noticeError<span class="signature">(error, customAttributes<span class="signature-attributes">opt</span>, expected)</span><span class="type-signature"> &rarr; {false|undefined}</span></h3><div class="description"><p>Send errors to New Relic that you've already handled yourself. Should be an <code>Error</code> or one of its subtypes, but the API will handle strings and objects that have an attached <code>.message</code> or <code>.stack</code> property.</p><p>NOTE: Errors that are recorded using this method do <em>not</em> obey the <code>ignore_status_codes</code> configuration.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>error</code></td><td class="type"><span class="param-type">Error</span></td><td class="attributes"></td><td class="description last"><p>The error to be traced.</p></td></tr><tr><td class="name"><code>customAttributes</code></td><td class="type"><span class="param-type">object</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Optional. Any custom attributes to be displayed in the New Relic UI.</p></td></tr><tr><td class="name"><code>expected</code></td><td class="type"><span class="param-type">boolean</span></td><td class="attributes"></td><td class="description last"><p>Optional. False by default. True if the error is expected, meaning it should be collected for error events and traces, but should not impact error rate.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line426">line 426</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>Returns false when disabled/errored, otherwise undefined</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">false</span> |<wbr> <span class="param-type">undefined</span></dd></dl></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>try {
 performSomeTask();
} catch (err) {
 newrelic.noticeError(
   err,
   {extraInformation: "error already handled in the application"},
   true
 );
}</code></pre></div></div><h3 class="name has-anchor" id="obfuscateSql"><span class="type-signature"></span>obfuscateSql<span class="signature">(sql, dialect)</span><span class="type-signature"> &rarr; {string}</span></h3><div class="description"><p>Obfuscates SQL for a given database engine.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>sql</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>sql statement</p></td></tr><tr><td class="name"><code>dialect</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>engine of the sql (mysql, postgres, cassandra, oracle)</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1777">line 1777</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>sql that obfuscates raw values</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">string</span></dd></dl></div><h3 class="name has-anchor" id="recordCustomEvent"><span class="type-signature"></span>recordCustomEvent<span class="signature">(eventType, attributes)</span><span class="type-signature"> &rarr; {false|undefined}</span></h3><div class="description"><p>Record custom event data which can be queried in New Relic Insights.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>eventType</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The name of the event. It must be an alphanumeric string less than 255 characters.</p></td></tr><tr><td class="name"><code>attributes</code></td><td class="type"><span class="param-type">object</span></td><td class="description last"><p>Object of key and value pairs. The keys must be shorter than 255 characters, and the values must be string, number, or boolean.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1250">line 1250</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>Returns false explicitly if failed/disabled, otherwise undefined</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">false</span> |<wbr> <span class="param-type">undefined</span></dd></dl></div><h3 class="name has-anchor" id="recordLlmFeedbackEvent"><span class="type-signature"></span>recordLlmFeedbackEvent<span class="signature">(params)</span></h3><div class="description"><p>Record a LLM feedback event which can be viewed in New Relic API Monitoring.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>params</code></td><td class="type"><span class="param-type">object</span></td><td class="description last"><p>Input parameters.</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>traceId</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>Identifier for the feedback event. Obtained from <code>getTraceMetadata</code>.</p></td></tr><tr><td class="name"><code>category</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>A tag for the event.</p></td></tr><tr><td class="name"><code>rating</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>A indicator of how useful the message was.</p></td></tr><tr><td class="name"><code>message</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>The message that triggered the event.</p></td></tr><tr><td class="name"><code>metadata</code></td><td class="type"><span class="param-type">object</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Additional key-value pairs to associate with the recorded event.</p></td></tr></tbody></table></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1580">line 1580</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="recordLogEvent"><span class="type-signature"></span>recordLogEvent<span class="signature">(logEvent)</span></h3><div class="description"><p>Sends an application log message to New Relic. The agent already automatically does this for some instrumented logging libraries, but in case you are using another logging method that is not already instrumented by the agent, you can use this function instead.</p><p>If application log forwarding is disabled in the agent configuration, this function does nothing.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>logEvent</code></td><td class="type"><span class="param-type">object</span></td><td class="description last"><p>The log event object to send. Any attributes besides <code>message</code>, <code>level</code>, <code>timestamp</code>, and <code>error</code> are recorded unchanged. The <code>logEvent</code> object itself will be mutated by this function.</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>message</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The log message.</p></td></tr><tr><td class="name"><code>level</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The log level severity. If this key is missing, it will default to UNKNOWN</p></td></tr><tr><td class="name"><code>timestamp</code></td><td class="type"><span class="param-type">number</span></td><td class="description last"><p>ECMAScript epoch number denoting the time that this log message was produced. If this key is missing, it will default to the output of <code>Date.now()</code>.</p></td></tr><tr><td class="name"><code>error</code></td><td class="type"><span class="param-type">Error</span></td><td class="description last"><p>Error associated to this log event. Ignored if missing.</p></td></tr></tbody></table></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line494">line 494</a></li></ul></dd></div></dl><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>newrelic.recordLogEvent({
 message: 'cannot find file',
 level: 'ERROR',
 error: new SystemError('missing.txt')
})</code></pre></div></div><h3 class="name has-anchor" id="recordMetric"><span class="type-signature"></span>recordMetric<span class="signature">(name, value)</span></h3><div class="description"><p>Record a custom metric, usually associated with a particular duration. The <code>name</code> must be a string following standard metric naming rules. The <code>value</code> will usually be a number, but it can also be an object. When <code>value</code> is a numeric value, it should represent the magnitude of a measurement associated with an event; for example, the duration for a particular method call. When <code>value</code> is an object, it must contain count, total, min, max, and sumOfSquares keys, all with number values. This form is useful to aggregate metrics on your own and report them periodically; for example, from a setInterval. These values will be aggregated with any previously collected values for the same metric. The names of these keys match the names of the keys used by the platform API.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>name</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The name of the metric.</p></td></tr><tr><td class="name"><code>value</code></td><td class="type"><span class="param-type">number</span> |<wbr> <span class="param-type">object</span></td><td class="description last"><p>The value of the metric to record</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1162">line 1162</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="setControllerName"><span class="type-signature"></span>setControllerName<span class="signature">(name, action)</span><span class="type-signature"> &rarr; {void}</span></h3><div class="description"><p>Give the current transaction a name based on your own idea of what constitutes a controller in your Node application. Also allows you to optionally specify the action being invoked on the controller. If the action is omitted, then the API will default to using the HTTP method used in the request (e.g. GET, POST, DELETE). Overrides any New Relic naming rules set in configuration or from New Relic's servers.</p><p>IMPORTANT: this function must be called when a transaction is active. New Relic transactions are tied to web requests, so this method may be called from within HTTP or HTTPS listener functions, Express routes, or other contexts where a web request or response object are in scope.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>name</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The name you want to give the controller in the New Relic UI. Will be prefixed with 'Controller/' when sent.</p></td></tr><tr><td class="name"><code>action</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The action being invoked on the controller. Defaults to the HTTP method used for the request.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line222">line 222</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">void</span></dd></dl></div><h3 class="name has-anchor" id="setDispatcher"><span class="type-signature"></span>setDispatcher<span class="signature">(name, version<span class="signature-attributes">opt</span>)</span></h3><div class="description"><p>Specify the <code>Dispatcher</code> and <code>Dispatcher Version</code> environment values. A dispatcher is typically the service responsible for brokering the request with the process responsible for responding to the request. For example Node's <code>http</code> module would be the dispatcher for incoming HTTP requests.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>name</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>The string you would like to report to New Relic as the dispatcher.</p></td></tr><tr><td class="name"><code>version</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>The dispatcher version you would like to report to New Relic</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line182">line 182</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="setErrorGroupCallback"><span class="type-signature"></span>setErrorGroupCallback<span class="signature">(callback)</span></h3><div class="description"><p>Function for adding a custom callback to generate Error Group names, which will be used by the Errors Inbox to group similar errors together via the <code>error.group.name</code> agent attribute.</p><p>Provided functions must return a string, and receive an object as an argument, which contains information related to the Error that occurred, and has the following format:</p><pre class="prettyprint source"><code>{
  customAttributes: object,
  'request.uri': string,
  'http.statusCode': string,
  'http.method': string,
  error: Error,
  'error.expected': boolean
}
</code></pre><p>Calling this function multiple times will replace previously defined functions</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>callback</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>callback function to generate <code>error.group.name</code> attribute</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1860">line 1860</a></li></ul></dd></div></dl><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>function myCallback(metadata) {
  if (metadata['http.statusCode'] === '400') {
    return 'Bad User Input'
  }
}
newrelic.setErrorGroupCallback(myCallback)</code></pre></div></div><h3 class="name has-anchor" id="setLlmTokenCountCallback"><span class="type-signature"></span>setLlmTokenCountCallback<span class="signature">(callback)</span></h3><div class="description"><p>Registers a callback which will be used for calculating token counts on Llm events when they are not available. This function will typically only be used if <code>ai_monitoring.record_content.enabled</code> is false and you want to still capture token counts for Llm events.</p><p>Provided callbacks must return an integer value for the token count for a given piece of content.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>callback</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>synchronous function called to calculate token count for content.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1893">line 1893</a></li></ul></dd></div></dl><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>// @param {string} model - name of model (i.e. gpt-3.5-turbo)
// @param {string} content - prompt or completion response
function tokenCallback(model, content) {
 // calculate tokens based on model and content
 // return token count
 return 40
}</code></pre></div></div><h3 class="name has-anchor" id="setTransactionName"><span class="type-signature"></span>setTransactionName<span class="signature">(name)</span><span class="type-signature"> &rarr; {void}</span></h3><div class="description"><p>Give the current transaction a custom name. Overrides any New Relic naming rules set in configuration or from New Relic's servers.</p><p>IMPORTANT: this function must be called when a transaction is active. New Relic transactions are tied to web requests, so this method may be called from within HTTP or HTTPS listener functions, Express routes, or other contexts where a web request or response object are in scope.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>name</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The name you want to give the web request in the New Relic UI. Will be prefixed with 'Custom/' when sent.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line92">line 92</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">void</span></dd></dl></div><h3 class="name has-anchor" id="setUserID"><span class="type-signature"></span>setUserID<span class="signature">(id)</span></h3><div class="description"><p>Assigns <code>enduser.id</code> attribute on transaction and trace events. It will also assign the attribute to errors if they occur within a transaction.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>id</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>a unique identifier used to set the <code>enduser.id</code> attribute</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1790">line 1790</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="shutdown"><span class="type-signature"></span>shutdown<span class="signature">(options<span class="signature-attributes">opt</span>, cb<span class="signature-attributes">opt</span>)</span></h3><div class="description"><p>Shuts down the agent.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>options</code></td><td class="type"><span class="param-type">object</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Object with shut down options.</p><h6>Properties</h6><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>collectPendingData</code></td><td class="type"><span class="param-type">boolean</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>If true, the agent will send any pending data to the collector before shutting down.</p></td></tr><tr><td class="name"><code>timeout</code></td><td class="type"><span class="param-type">number</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Time in milliseconds to wait before shutting down.</p></td></tr><tr><td class="name"><code>waitForIdle</code></td><td class="type"><span class="param-type">boolean</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>If true, the agent will not shut down until there are no active transactions.</p></td></tr></tbody></table></td></tr><tr><td class="name"><code>cb</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Callback function that runs when agent stops.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1635">line 1635</a></li></ul></dd></div></dl><h3 class="name has-anchor" id="startBackgroundTransaction"><span class="type-signature"></span>startBackgroundTransaction<span class="signature">(name, group<span class="signature-attributes">opt</span>, handle)</span><span class="type-signature"> &rarr; {null|*}</span></h3><div class="description"><p>Creates and starts a background transaction to record work done in the handle supplied. This transaction will run until the handle synchronously returns UNLESS:</p><ol><li>The handle function returns a promise, where the end of the transaction will be tied to the end of the promise returned.</li><li><a href="API.html#getTransaction"><code>API#getTransaction</code></a> is called in the handle, flagging the transaction as externally handled. In this case the transaction will be ended when <a href="TransactionHandle.html#end"><code>TransactionHandle#end</code></a> is called in the user's code.</li></ol></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>name</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>The name of the transaction. It is used to name and group related transactions in APM, so it should be a generic name and not include any variable parameters.</p></td></tr><tr><td class="name"><code>group</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>Optional, used for grouping background transactions in APM. For more information see: https://docs.newrelic.com/docs/apm/applications-menu/monitoring/transactions-page#txn-type-dropdown</p></td></tr><tr><td class="name"><code>handle</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes"></td><td class="description last"><p>Function that represents the background work.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1046">line 1046</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>Returns null if handle is not a function, otherwise the return value of handle</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">null</span> |<wbr> <span class="param-type">*</span></dd></dl></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>const newrelic = require('newrelic')
newrelic.startBackgroundTransaction('Red October', 'Subs', function() {
  const transaction = newrelic.getTransaction()
  setTimeout(function() {
    // do some work
    transaction.end()
  }, 100)
})</code></pre></div></div><h3 class="name has-anchor" id="startSegment"><span class="type-signature"></span>startSegment<span class="signature">(name, record, handler, callback<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {*}</span></h3><div class="description"><p>Wraps the given handler in a segment which may optionally be turned into a metric.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th>Attributes</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>name</code></td><td class="type"><span class="param-type">string</span></td><td class="attributes"></td><td class="description last"><p>The name to give the new segment. This will also be the name of the metric.</p></td></tr><tr><td class="name"><code>record</code></td><td class="type"><span class="param-type">boolean</span></td><td class="attributes"></td><td class="description last"><p>Indicates if the segment should be recorded as a metric. Metrics will show up on the transaction breakdown table and server breakdown graph. Segments just show up in transaction traces.</p></td></tr><tr><td class="name"><code>handler</code></td><td class="type"><span class="param-type"><a href="global.html#startSegmentCallback">startSegmentCallback</a></span></td><td class="attributes"></td><td class="description last"><p>The function to track as a segment.</p></td></tr><tr><td class="name"><code>callback</code></td><td class="type"><span class="param-type">function</span></td><td class="attributes">&lt;optional><br></td><td class="description last"><p>An optional callback for the handler. This will indicate the end of the timing if provided.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line879">line 879</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>Returns the result of calling <code>handler</code>.</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">*</span></dd></dl></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>newrelic.startSegment('mySegment', false, function handler() {
   // The returned promise here will signify the end of the segment.
   return myAsyncTask().then(myNextTask)
 })</code></pre></div></div><h3 class="name has-anchor" id="startWebTransaction"><span class="type-signature"></span>startWebTransaction<span class="signature">(url, handle)</span><span class="type-signature"> &rarr; {null|*}</span></h3><div class="description"><p>Creates and starts a web transaction to record work done in the handle supplied. This transaction will run until the handle synchronously returns UNLESS:</p><ol><li>The handle function returns a promise, where the end of the transaction will be tied to the end of the promise returned.</li><li><a href="API.html#getTransaction"><code>API#getTransaction</code></a> is called in the handle, flagging the transaction as externally handled. In this case the transaction will be ended when <a href="TransactionHandle.html#end"><code>TransactionHandle#end</code></a> is called in the user's code.</li></ol></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>url</code></td><td class="type"><span class="param-type">string</span></td><td class="description last"><p>The URL of the transaction. It is used to name and group related transactions in APM, so it should be a generic name and not include any variable parameters.</p></td></tr><tr><td class="name"><code>handle</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>Function that represents the transaction work.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line943">line 943</a></li></ul></dd></div></dl><div class="method-member-container mt-20"><strong>Returns:</strong><div class="param-desc"><p>Returns null if handle is not a function, otherwise the return value of handle</p></div><dl class="param-type"><dt>Type:&nbsp;</dt><dd><span class="param-type">null</span> |<wbr> <span class="param-type">*</span></dd></dl></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>const newrelic = require('newrelic')
newrelic.startWebTransaction('/some/url/path', function() {
  const transaction = newrelic.getTransaction()
  setTimeout(function() {
    // do some work
    transaction.end()
  }, 100)
})</code></pre></div></div><h3 class="name has-anchor" id="withLlmCustomAttributes"><span class="type-signature"></span>withLlmCustomAttributes<span class="signature">(context, callback)</span></h3><div class="description"><p>Run a function with the passed in LLM context as the active context and return its return value.</p></div><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Parameters:</strong><table class="params"><thead><tr><th>Name</th><th>Type</th><th class="last">Description</th></tr></thead><tbody><tr><td class="name"><code>context</code></td><td class="type"><span class="param-type">object</span></td><td class="description last"><p>LLM custom attributes context</p></td></tr><tr><td class="name"><code>callback</code></td><td class="type"><span class="param-type">function</span></td><td class="description last"><p>The function to execute in context.</p></td></tr></tbody></table></div><dl class="details"><div class="details-item-container"><dt class="tag-source bold">Source</dt><dd class="tag-source"><ul><li><a href="api.js.html">api.js</a>, <a href="api.js.html#line1943">line 1943</a></li></ul></dd></div></dl><div class="method-member-container flex flex-col w-100 overflow-auto mt-20"><strong>Example</strong><div class="rel"><pre class="prettyprint"><code>const OpenAI = require('openai')
const client = new OpenAI()
newrelic.withLlmCustomAttributes({'llm.someAttribute': 'someValue'}, async () => {
   const response = await client.chat.completions.create({ messages: [
     { role: 'user', content: 'Tell me about Node.js.'}
   ]})
})</code></pre></div></div></article></section></div></div></div><div class="mobile-menu-icon-container"><button class="icon-button" id="mobile-menu" data-isopen="false" aria-label="menu"><svg><use xlink:href="#menu-icon"></use></svg></button></div><div id="mobile-sidebar" class="mobile-sidebar-container"><div class="mobile-sidebar-wrapper"><div class="mobile-nav-links"></div><div class="mobile-sidebar-items-c"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="API.html">API</a></div><div class="sidebar-section-children"><a href="ClassWrapSpec.html">ClassWrapSpec</a></div><div class="sidebar-section-children"><a href="DatastoreParameters.html">DatastoreParameters</a></div><div class="sidebar-section-children"><a href="DatastoreShim.html">DatastoreShim</a></div><div class="sidebar-section-children"><a href="InstrumentationDescriptor.html">InstrumentationDescriptor</a></div><div class="sidebar-section-children"><a href="MessageShim.html">MessageShim</a></div><div class="sidebar-section-children"><a href="MessageSpec.html">MessageSpec</a></div><div class="sidebar-section-children"><a href="MessageSubscribeSpec.html">MessageSubscribeSpec</a></div><div class="sidebar-section-children"><a href="MiddlewareMounterSpec.html">MiddlewareMounterSpec</a></div><div class="sidebar-section-children"><a href="MiddlewareSpec.html">MiddlewareSpec</a></div><div class="sidebar-section-children"><a href="OperationSpec.html">OperationSpec</a></div><div class="sidebar-section-children"><a href="PromiseShim.html">PromiseShim</a></div><div class="sidebar-section-children"><a href="QuerySpec.html">QuerySpec</a></div><div class="sidebar-section-children"><a href="QueueMessageParameters.html">QueueMessageParameters</a></div><div class="sidebar-section-children"><a href="RecorderSpec.html">RecorderSpec</a></div><div class="sidebar-section-children"><a href="RenderSpec.html">RenderSpec</a></div><div class="sidebar-section-children"><a href="SegmentSpec.html">SegmentSpec</a></div><div class="sidebar-section-children"><a href="Shim.html">Shim</a></div><div class="sidebar-section-children"><a href="TransactionHandle.html">TransactionHandle</a></div><div class="sidebar-section-children"><a href="TransactionShim.html">TransactionShim</a></div><div class="sidebar-section-children"><a href="TransactionSpec.html">TransactionSpec</a></div><div class="sidebar-section-children"><a href="WebFrameworkShim.html">WebFrameworkShim</a></div><div class="sidebar-section-children"><a href="WrapSpec.html">WrapSpec</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-instrumentation.html">Instrumentation Examples</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-interfaces"><div>Interfaces</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="ParsedQueryData.html">ParsedQueryData</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-global"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#CallbackBindFunction">CallbackBindFunction</a></div><div class="sidebar-section-children"><a href="global.html#ClassWrapSpecParams">ClassWrapSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#ConstructorHookFunction">ConstructorHookFunction</a></div><div class="sidebar-section-children"><a href="global.html#DatastoreParametersParams">DatastoreParametersParams</a></div><div class="sidebar-section-children"><a href="global.html#InContextCallback">InContextCallback</a></div><div class="sidebar-section-children"><a href="global.html#InstrumentationDescriptorParams">InstrumentationDescriptorParams</a></div><div class="sidebar-section-children"><a href="global.html#InstrumentationOnError">InstrumentationOnError</a></div><div class="sidebar-section-children"><a href="global.html#InstrumentationOnRequire">InstrumentationOnRequire</a></div><div class="sidebar-section-children"><a href="global.html#MessageBrokerHeadersFn">MessageBrokerHeadersFn</a></div><div class="sidebar-section-children"><a href="global.html#MessageConsumerWrapperFunction">MessageConsumerWrapperFunction</a></div><div class="sidebar-section-children"><a href="global.html#MessageFunction">MessageFunction</a></div><div class="sidebar-section-children"><a href="global.html#MessageHandlerFunction">MessageHandlerFunction</a></div><div class="sidebar-section-children"><a href="global.html#MessageSpecParams">MessageSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#MessageSubscribeSpecParams">MessageSubscribeSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#MiddlewareMounterSpecParams">MiddlewareMounterSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#MiddlewareSpecParams">MiddlewareSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#MiddlewareTypeNames">MiddlewareTypeNames</a></div><div class="sidebar-section-children"><a href="global.html#MiddlewareWrapperFunction">MiddlewareWrapperFunction</a></div><div class="sidebar-section-children"><a href="global.html#OperationSpecParams">OperationSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#QueryFunction">QueryFunction</a></div><div class="sidebar-section-children"><a href="global.html#QueryParserFunction">QueryParserFunction</a></div><div class="sidebar-section-children"><a href="global.html#QuerySpecFunction">QuerySpecFunction</a></div><div class="sidebar-section-children"><a href="global.html#QuerySpecParams">QuerySpecParams</a></div><div class="sidebar-section-children"><a href="global.html#QueueMessageParametersParams">QueueMessageParametersParams</a></div><div class="sidebar-section-children"><a href="global.html#RecorderFunction">RecorderFunction</a></div><div class="sidebar-section-children"><a href="global.html#RecorderSpecParams">RecorderSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#RenderSpecParams">RenderSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#ResponsePredicate">ResponsePredicate</a></div><div class="sidebar-section-children"><a href="global.html#RouteNextFunction">RouteNextFunction</a></div><div class="sidebar-section-children"><a href="global.html#RouteParameterFunction">RouteParameterFunction</a></div><div class="sidebar-section-children"><a href="global.html#RouteParserFunction">RouteParserFunction</a></div><div class="sidebar-section-children"><a href="global.html#RouteRequestFunction">RouteRequestFunction</a></div><div class="sidebar-section-children"><a href="global.html#SegmentFunction">SegmentFunction</a></div><div class="sidebar-section-children"><a href="global.html#SegmentSpecParams">SegmentSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#SpecAfterFunction">SpecAfterFunction</a></div><div class="sidebar-section-children"><a href="global.html#TransactionSpecParams">TransactionSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#WrapFunction">WrapFunction</a></div><div class="sidebar-section-children"><a href="global.html#WrapSpecParams">WrapSpecParams</a></div><div class="sidebar-section-children"><a href="global.html#createShimFromType">createShimFromType</a></div><div class="sidebar-section-children"><a href="global.html#getDatabaseNameFromUseQuery">getDatabaseNameFromUseQuery</a></div><div class="sidebar-section-children"><a href="global.html#startSegmentCallback">startSegmentCallback</a></div></div></div><div class="mobile-navbar-actions"><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div></div></div><script type="text/javascript" src="scripts/core.min.js"></script><script src="scripts/search.min.js" defer="defer"></script><script src="scripts/third-party/fuse.js" defer="defer"></script><script type="text/javascript">var tocbotInstance=tocbot.init({tocSelector:"#eed4d2a0bfd64539bb9df78095dec881",contentSelector:".main-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0,scrollContainer:".main-content",headingsOffset:130,onClick:bringLinkToView})</script></body></html>